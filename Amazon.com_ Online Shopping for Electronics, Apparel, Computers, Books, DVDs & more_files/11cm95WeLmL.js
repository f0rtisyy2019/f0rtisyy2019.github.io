(function(d){var e=window.AmazonUIPageJS||window.P,f=e._namespace||e.attributeErrors,c=f?f("AmazonLiveMetricsUtils",""):e;c.guardFatal?c.guardFatal(d)(c,window):c.execute(function(){d(c,window)})})(function(d,e,f){d.when("A").register("amazon-live-sushi-metrics",function(c){var b={EVENT_ID:"event_id",REPORTED_TIME:"reported_time",REQUEST_ID:"request_id",SESSION_ID:"session_id",MARKETPLACE_ID:"marketplace_id",STREAM_SESSION_ID:"stream_session_id",CUSTOMER_ID:"customer_id",BROADCAST_ID:"broadcast_id",
BROADCAST_ID_TYPE:"broadcast_id_type",ASIN:"asin",PAGE_TYPE:"page_type",PAGE_ID:"page_id",WIDGET:"widget",SLOT_ID:"slot_id",EVENT_TYPE:"event_type",EVENT_TRIGGER_TYPE:"event_trigger_type",PROMOTED_ITEM_ID:"promoted_item_id",BROADCAST_STATUS:"broadcast_status",PLAYER_STATUS:"player_status",WEBLAB_IDS:"weblab_ids",REF_MARKER:"ref_marker",USER_AGENT:"user_agent",TRAFFIC_TYPE:"traffic_type",STRING_PAYLOAD:"string_payload",INT_PAYLOAD:"int_payload",JSON_PAYLOAD:"json_payload",CONTEXT:"context",PLATFORM:"platform",
EXPERIENCE:"experience",SLOT_NAME:"slot_name"},a,d=function(g){a||(a={},a[b.EVENT_ID]="",a[b.REQUEST_ID]="",a[b.SESSION_ID]="",a[b.MARKETPLACE_ID]="",a[b.STREAM_SESSION_ID]="",a[b.CUSTOMER_ID]="",a[b.BROADCAST_ID]="",a[b.BROADCAST_ID_TYPE]="",a[b.ASIN]="",a[b.PAGE_TYPE]="",a[b.PAGE_ID]="",a[b.WIDGET]="",a[b.SLOT_ID]="",a[b.EVENT_TYPE]="",a[b.EVENT_TRIGGER_TYPE]="",a[b.PROMOTED_ITEM_ID]="",a[b.BROADCAST_STATUS]="",a[b.PLAYER_STATUS]="",a[b.WEBLAB_IDS]="",a[b.REF_MARKER]="",a[b.USER_AGENT]=navigator.userAgent,
a[b.TRAFFIC_TYPE]="",a[b.STRING_PAYLOAD]="",a[b.INT_PAYLOAD]="",a[b.JSON_PAYLOAD]="",a[b.CONTEXT]="",a[b.PLATFORM]="",a[b.EXPERIENCE]="",a[b.SLOT_NAME]="");a[b.REPORTED_TIME]=Math.floor((new Date).getTime());return g=c.$.extend(!0,{},a,g)},f=function(a){return JSON.stringify({events:[{data:a}]}).replace(/\\\\/g,"")};return{emitMetricsPayload:function(a,h){a=d(a);c.$.ajax({url:"https://unagi-na.amazon.com/1/events/com.amazon.eel.amazonlive.metrics.nexus",data:f(a),type:"POST",contentType:"application/json; charset\x3dutf-8",
success:function(){e.ue&&e.ue.count("amazonLiveSushiLoggingSuccess",1);if(h){var d=a,f=c.$.param(d);c.$("body").append(c.$("\x3cdiv\x3e\x3c/div\x3e").attr("class","sushi-customer-csm-"+d[b.EVENT_TYPE]).attr("value",decodeURIComponent(f).replace(/\+/g," ")))}},error:function(){e.ue&&e.ue.count("amazonLiveSushiLoggingFailure",1)}})},buildMetricsPayload:d,formatPayload:f,metricSchema:b}})});